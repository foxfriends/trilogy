engine: "nixery"

when:
  - event: ["push", "pull_request"]
    branch: "main"

dependencies:
  nixpkgs:
    - "rustup"
    - "clang_18"
    - "valgrind"
    - "openssl"

steps:
  - name: "Install Rust"
    command: |
      rustup toolchain install stable
      rustup component add rustfmt
      rustup component add clippy
  - name: "Format"
    command: "cargo fmt -- --check"
  - name: "Clippy"
    command: "cargo clippy -- -D warnings"
  - name: "Test"
    command: "cargo test"
