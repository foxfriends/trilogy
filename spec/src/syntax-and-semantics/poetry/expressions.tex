\subsubsection{Expressions}
\label{sec:expressions}

Seeing as the entirety of \Poetry{} (and admittedly, much of \Trilogy{} as a whole)
is made up of expressions, there are a lot of cases.

Though the expression grammar does include binary operators and other binary keywords
\Trilogy{} does not encode precedence as part of the grammar but instead resolves that
in a later pass in the interpreter (\S\ref{sec:precedence}).

Finally, note that there are two expression-like productions in the grammar:
$\bnfpn{Expression}$ and $\bnfpn{Expr}$, the difference being that the first
is a full expression including effect handlers directly, while the second is
a more traditional value expression. Effect handlers in \Trilogy{} really
could be supplied on any expression, at any time, but since they have a tendency
to be large, and in terms of precedence do not mean much intuitively, it is
generally required to parenthesize effect handlers, if it might be at all
ambiguous.

\begin{bnf*}
    \bnfprod{Expression}{
        \bnfpn{Expr}
        \bnfor
        \bnfpn{Expr}
        \bnfsp
        \bnfpn{EffectHandlers}
    } \\
    \bnfprod{Expr}{
        \bnfpn{Primitive}
        \bnfor
        \bnfpn{Compound}
        \bnfor
        \bnfpn{Comprehension}
        \bnfor
    } \\
    \bnfmore{
        \bnfpn{Reference}
        \bnfor
        \bnfpn{MemberAccess}
        \bnfor
        \bnfpn{Application}
        \bnfor
    } \\
    \bnfmore{
        \bnfpn{ProcedureCall}
        \bnfor
        \bnfpn{BinOp}
        \bnfor
        \bnfpn{UnaryOp}
        \bnfor
    } \\
    \bnfmore{
        \bnfpn{Let}
        \bnfor
        \bnfpn{IfElse}
        \bnfor
        \bnfpn{Match}
        \bnfor
        \bnfpn{Is}
        \bnfor
        \bnfpn{End}
        \bnfor
    } \\
    \bnfmore{
        \bnfpn{Resume}
        \bnfor
        \bnfpn{Cancel}
        \bnfor
        \bnfpn{Return}
        \bnfor
        \bnfpn{Break}
        \bnfor
    } \\
    \bnfmore{
        \bnfpn{Continue}
        \bnfor
        \bnfpn{FnClosure}
        \bnfor
        \bnfpn{DoClosure}
        \bnfor
    } \\
    \bnfmore{
        \bnfpn{Template}
        \bnfor
        \bnfts{(}
        \bnfsp
        \bnfpn{Expression}
        \bnfsp
        \bnfts{)}
    }
\end{bnf*}
