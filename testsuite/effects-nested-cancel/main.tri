import "trilogy:io" use println

proc do_inner!() {
  assert 'hello == yield 'get_hello
  return true
}

proc do_things!() {
  with do_inner!() { else yield }
  assert "don't go here" as false
  return false
}

proc main!() {
  assert 'hello == with do_things!() {
    when 'get_hello cancel 'hello
    else yield
  }
  println!("Made it to end")
}
