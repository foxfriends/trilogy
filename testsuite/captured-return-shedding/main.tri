import "trilogy:io" use println

proc inner!() {
  let ret = (return)
  with ret 3
    when 'eff then {
      println!("hello")
      cancel false
    }
    else yield
}

proc outer!() {
  assert inner!() == 3
  yield 'eff
}

proc main!() {
  assert with outer!() when 'eff cancel true else cancel false
}
